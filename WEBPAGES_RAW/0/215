<!DOCTYPE html 
    PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
  <title>SLI | Classes / iCAMP Undergraduate Summer Research: Collaborative Filtering </title>
  <meta http-equiv='Content-Style-Type' content='text/css' />
  <link rel='stylesheet' href='http://sli.ics.uci.edu/pmwiki/pub/skins/custom/pmwiki.css' type='text/css' />
  <!--HTMLHeader--><style type='text/css'><!--
  ul, ol, pre, dl, p { margin-top:0px; margin-bottom:0px; }
  code.escaped { white-space: nowrap; }
  .vspace { margin-top:1.33em; }
  .indent { margin-left:40px; }
  .outdent { margin-left:40px; text-indent:-40px; }
  a.createlinktext { text-decoration:none; border-bottom:1px dotted gray; }
  a.createlink { text-decoration:none; position:relative; top:-0.5em;
    font-weight:bold; font-size:smaller; border-bottom:none; }
  img { border:0px; }
  .editconflict { color:green; 
  font-style:italic; margin-top:1.33em; margin-bottom:1.33em; }

  table.markup { border:2px dotted #ccf; width:90%; }
  td.markup1, td.markup2 { padding-left:10px; padding-right:10px; }
  table.vert td.markup1 { border-bottom:1px solid #ccf; }
  table.horiz td.markup1 { width:23em; border-right:1px solid #ccf; }
  table.markup caption { text-align:left; }
  div.faq p, div.faq pre { margin-left:2em; }
  div.faq p.question { margin:1em 0 0.75em 0; font-weight:bold; }
  div.faqtoc div.faq * { display:none; }
  div.faqtoc div.faq p.question 
    { display:block; font-weight:normal; margin:0.5em 0 0.5em 20px; line-height:normal; }
  div.faqtoc div.faq p.question * { display:inline; }
   
    .frame 
      { border:1px solid #cccccc; padding:4px; background-color:#f9f9f9; }
    .lfloat { float:left; margin-right:0.5em; }
    .rfloat { float:right; margin-left:0.5em; }
a.varlink { text-decoration:none;}

--></style>  <meta name='robots' content='index,follow' />

</head>
<body>
<!--PageHeaderFmt-->
  <div id='wikilogo'><a href='http://sli.ics.uci.edu'><img src='/pmwiki/pub/skins/custom/SLI_white.png'
    alt='SLI' border='0' /></a></div>
  <div id='wikihead'>
  <form action='http://sli.ics.uci.edu'>
    <!-- <span class='headnav'><a href='http://sli.ics.uci.edu/Classes/RecentChanges'
      accesskey='c'>Recent Changes</a> -</span> --> 
    <input type='hidden' name='n' value='Classes.2013-iCamp' />
    <input type='hidden' name='action' value='search' />
    <!-- <a href='http://sli.ics.uci.edu/Site/Search'>Search</a>: -->
    <input type='text' name='q' value='' class='inputbox searchbox' />
    <input type='submit' class='inputbutton searchbutton'
      value='Search' />
    <a href='http://sli.ics.uci.edu/Site/Search'>(?)</a>
  </form></div>
<!--/PageHeaderFmt-->
  <table id='wikimid' width='100%' cellspacing='0' cellpadding='0'><tr>
<!--PageLeftFmt-->
      <td id='wikileft' valign='top'>
        <ul><li><a class='wikilink' href='http://sli.ics.uci.edu/Classes/Classes'>Classes</a>
</li><li><a class='wikilink' href='http://sli.ics.uci.edu/Group/Group'>Group</a>
</li><li><a class='wikilink' href='http://sli.ics.uci.edu/Projects/Projects'>Research</a>
</li><li><a class='urllink' href='http://www.ics.uci.edu/~ihler/pubs.html' rel='nofollow'>Publications</a>
</li><li><a class='wikilink' href='http://sli.ics.uci.edu/Code/Code'>Code</a>
</li></ul><div class='vspace'></div><hr />
<div class='vspace'></div>
</td>
<!--/PageLeftFmt-->
      <td id='wikibody' valign='top'>
<!--PageActionFmt-->
        <div id='wikicmds'><ul><li class='browse'><a class='wikilink' href='http://sli.ics.uci.edu/Classes/2013-iCamp?action=login'>login</a>
</li></ul>
</div>
<!--PageTitleFmt-->
        <div id='wikititle'>
          <div class='pagegroup'><a href='http://sli.ics.uci.edu/Classes'>Classes</a> /</div>
          <h1 class='pagetitle'>iCAMP Undergraduate Summer Research: Collaborative Filtering</h1></div>
<!--PageText-->
<div id='wikitext'>
<p><span style='font-size:173%'><span  style='color: red;'> CLOSED : 2013 OFFERING </span> </span>
</p><h2>See also the <a class='urllink' href='https://www.math.uci.edu/~icamp/' rel='nofollow'>main iCamp page</a></h2>
<hr />
<h2>Schedule</h2>
<h3>Skills workshops: Tuesdays 1-3pm, Roland Hall 306 </h3>
<h3>Group meetings: Thurs 2+pm, Roland Hall 421 (PRISM Lab)</h3>
<h3>Instructor: <a class='urllink' href='http://www.ics.uci.edu/~ihler/' rel='nofollow'>Prof. Alex Ihler</a> (ihler@ics.uci.edu), Office Bren Hall 4066</h3>
<ul><li>Lab Hours: Mondays 1-2pm; Wed 4-5pm, PRISM Lab
</li></ul><h3>Teaching Assistant: <a class='urllink' href='http://www.ics.uci.edu/~sforouza' rel='nofollow'>Sholeh Forouzan</a> (sforouza@uci.edu)</h3>
<ul><li>Lab Hours: Mondays 4-5pm, Fri 1-3pm, PRISM Lab
</li></ul><div class='vspace'></div><hr />
<h3>Overview</h3>
<p>Many companies collect data at an unprecedented scale. Online stores such as Amazon collect click patterns and purchases by people navigating their webpages, credit score companies such as Experian and banks record clients' financial histories, Netflix records peoples' interest in movies, and so on.  A new field is starting to emerge known as "collaborative filtering" where this type of data is used to predict quantities of interest: What is the next book a customer would buy? Will this person pay his/her loan?, What are the next movies this customer will be interested in?
</p>
<p class='vspace'>For our summer undergraduate research project, we will participate in an international competition in collaborative filtering and recommendation systems, sponsored by the <a class='urllink' href='http://recsys.acm.org/recsys13/' rel='nofollow'>2013 RecSys Conference</a>.  The competition aspect is run by <a class='urllink' href='http://www.kaggle.com' rel='nofollow'>Kaggle</a>, an online data science and prediction hosting system.  This year, the RecSys competition data comes from <a class='urllink' href='http://www.yelp.com' rel='nofollow'>Yelp</a>, and involves predicting business ratings given past ratings by the same and other users, as well as a host of metadata such as business location, check-in information, and rating feedback from other users.  For the data and more details, please see the <a class='urllink' href='https://www.kaggle.com/c/yelp-recsys-2013' rel='nofollow'>Kaggle RecSys competition site</a>.
</p>
<div class='vspace'></div><hr />
<h3>Handouts and code</h3>
<ul><li>New train/validation split for testing: <a class='urllink' href='http://sli.ics.uci.edu/Classes/2013-iCamp?action=download&amp;upname=yelp_validate.mat' rel='nofollow'>MAT</a> (contains Dtrain and Dval), or <a class='urllink' href='http://sli.ics.uci.edu/Classes/2013-iCamp?action=download&amp;upname=make_validation.m' rel='nofollow'>Script</a> to construct MAT file
</li><li>Even newer data (Sholeh) <a class='urllink' href='http://sli.ics.uci.edu/Classes/2013-iCamp?action=download&amp;upname=yelp_data2.zip' rel='nofollow'>ZIP</a>
</li><li>NEW DATA FORMAT (Alex) <a class='urllink' href='http://sli.ics.uci.edu/Classes/2013-iCamp?action=download&amp;upname=yelp_data.zip' rel='nofollow'>ZIP</a> : run "help yelp_data"
</li><li>Reprocessed data <span  style='color: red;'>(UPDATED)</span> <a class='urllink' href='http://sli.ics.uci.edu/Classes/2013-iCamp?action=download&amp;upname=icamp-yelp-v2.zip' rel='nofollow'>ZIP</a>
<ul><li><del>Old reprocessed data: <a class='urllink' href='http://sli.ics.uci.edu/Classes/2013-iCamp?action=download&amp;upname=icamp-yelp.zip' rel='nofollow'>ZIP</a></del>
</li></ul></li></ul><hr />
<div class='Matlab' style='padding:5px; border:1px solid black; background-color:#dddddd' >
<pre> <span  style='color: green;'>% Some basic code for manipulating the data: </span><br />
 load yelp_data.mat  <span  style='color: green;'>% Load formatted data </span><br />
 <span  style='color: green;'>% Splitting the data into training and validation sets: </span><br /> nTotal = length(rev_train(:,4));
 pi = randperm(nTotal); nTrain = ceil(.8*nTotal);
 iTrain = pi(1:nTrain); iVal = pi(nTrain+1:end);
 <span  style='color: green;'>% Split into Training / Validation / Test   user/business/rating sets </span><br /> uTr = rev_train(iTrain,2); uVal = rev_train(iVal,2); uTe = rev_test(:,1);
 bTr = rev_train(iTrain,3); bVal = rev_train(iVal,3); bTe = rev_test(:,2);
 rTr = rev_train(iTrain,4); rVal = rev_train(iVal,4); rTe = -1 + 0*uTe;

 <span  style='color: green;'>% Construct sparse matrix formats with training &amp; validation data </span><br /> Dtr  = sparse([uTr;uVal;uTe],[bTr;bVal;bTe],[rTr;-1+0*rVal;-1+0*rTe]);
 Dval = sparse([uTr;uVal;uTe],[bTr;bVal;bTe],[rTr;rVal;-1+0*rTe]);
</pre></div>
<p class='vspace'>Some plots:
</p><div class='Matlab' style='padding:5px; border:1px solid black; background-color:#dddddd' >
<pre> <span  style='color: green;'>% The data exhibit a classic "scale free" property</span>
 uTrainIDs = find(user_average_stars &gt; 0); uTestIDs = find(user_average_stars &lt; 0);
 Htrain = hist( user_review_count(uTrainIDs), max(user_review_count) );
 Htest  = hist( user_review_count(uTestIDs), max(user_review_count) );
 figure; plot(log10(1:length(Htrain)),log10(Htrain+.5),'b.',log10(1:length(Htest)),log10(Htest+.5),'r.');
 <span  style='color: green;'>% offset shift mostly just due to different #s of training &amp; test data </span>

 <span  style='color: green;'>% Here's the geospatial distribution of businesses</span>
 lat = [business(:).latitude]; lon = [business(:).longitude];
 figure; plot(lat,lon,'b.');

 <span  style='color: green;'>% And here's the same thing with "test businesses" marked in red</span>
 bTestIDs = [business(:).stars]&lt;0;
 figure; plot(lat,lon,'b.',lat(bTestIDs),lon(bTestIDs),'r.');

 <span  style='color: green;'>% You can also try to highlight e.g. number of reviews at each business through size or color:</span>
 figure; scatter(lat,lon,log([business(:).review_count]));    <span  style='color: green;'>% size parameter</span>
 figure; scatter(lat,lon,[],log([business(:).review_count])); <span  style='color: green;'>% color parameter</span>

 <span  style='color: green;'>% let's look at some histograms of the data</span>
 figure; hist(rTr,1:5);                                                           <span  style='color: green;'>% more 4&amp;5 than 1&amp;2 ratings</span>
 <span  style='color: green;'>% Look at the errors of the per-item predictions:</span>
 Dhat = yelpMean(Dtr',Dval', 3)';  figure; hist(Dtr(Dtr&gt;0)-Dhat(Dtr&gt;0),-5:.01:5); 
 <span  style='color: green;'>% The biggest errors are on the low side; items averaging ~4 but rated 1-2 (?)</span>
</pre></div>
<p class='vspace'>A simple "sparse mean" function:
</p><div class='Matlab' style='padding:5px; border:1px solid black; background-color:#dddddd' >
<pre> function [D] = yelpMean(Dtrain,Dval, reg)
 <span  style='color: green;'>%function [D] = yelpMean(Dtrain, Dval, reg)</span>
 <span  style='color: green;'>% Take mean over items (so, per-user average) in sparse=missing data matrix</span>
 <span  style='color: green;'>% Dtrain : training values; -1 to be predicted; Dval : some -1's replaced with validation #s</span>
 <span  style='color: green;'>% Use  D = yelpMean(Dtrain',Dval',reg)'  to do per-item average</span>

 D = Dtrain;
 [nUsers,nItems]=size(D);
 DT = D';

 mnAll = mean(D(D(:)&gt;0));

 mn = (sum(DT,1)+reg*mnAll+sum(DT&lt;0,1))./(sum(DT&gt;0,1)+reg);
 for u=1:nUsers, fill=find(DT(:,u)); D(u,fill) = mn(u); end;
</pre></div>
</div>

      </td>
    </tr></table>
<!--PageFooterFmt-->
  <div id='wikifoot'>
    <div class='footnav' style='float:left'> Last modified January 19, 2015, at 04:35 PM</div>
    <div class='footnav' style='float:right; text-align:right'>
    <a href="http://www.ics.uci.edu">Bren School of Information and Computer Science</a><br>
    <a href="http://www.uci.edu">University of California, Irvine</a>
    </div>
  </div>
<!--HTMLFooter--><script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(["_setAccount", "UA-24148957-2"]);
	_gaq.push(["_trackPageview"]);
	(function() {
	  var ga = document.createElement("script"); ga.type = "text/javascript"; ga.async = true;
	  ga.src = ("https:" == document.location.protocol ? "https://ssl" : "http://www") + ".google-analytics.com/ga.js";
	  var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(ga, s);
	  })();
</script>
</body>
</html>
